cmake_minimum_required(VERSION 3.1)
project(SofaGuiQtOpenGL)

set(HEADER_FILES
    ../GLPickHandler.h
    ../viewer/GLBackend.h
    ../viewer/VisualModelPolicy.h
)

set(SOURCE_FILES
    ../GLPickHandler.cpp
    ../viewer/GLBackend.cpp
    ../viewer/VisualModelPolicy.cpp
)

# QtViewer
if(SOFAGUI_QTVIEWER)
    list(APPEND MOC_HEADER_FILES ../viewer/qt/QtViewer.h)
    list(APPEND SOURCE_FILES ../viewer/qt/QtViewer.cpp)
endif()

# QGLViewer
if(SOFAGUI_QGLVIEWER)
    list(APPEND MOC_HEADER_FILES ../viewer/qgl/QtGLViewer.h)
    list(APPEND SOURCE_FILES ../viewer/qgl/QtGLViewer.cpp)
endif()

set(CMAKE_AUTOMOC ON)
set(QT_USE_IMPORTED_TARGETS 1)

add_library(${PROJECT_NAME} SHARED ${MOC_HEADER_FILES} ${HEADER_FILES} ${SOURCE_FILES})

# For files generated by the moc
target_include_directories(${PROJECT_NAME} PUBLIC "$<BUILD_INTERFACE:${CMAKE_CURRENT_BINARY_DIR}>")
target_link_libraries(${PROJECT_NAME} PUBLIC SofaGuiQt)
if(SOFAGUI_QGLVIEWER)
    target_link_libraries(${PROJECT_NAME} PUBLIC QGLViewer)
endif()

set_target_properties(${PROJECT_NAME} PROPERTIES COMPILE_FLAGS "-DSOFA_BUILD_SOFAGUIQTOPENGL")

sofa_install_targets(SofaGui SofaGuiQtOpenGL "SofaGui/sofa/gui/qt/gl")

